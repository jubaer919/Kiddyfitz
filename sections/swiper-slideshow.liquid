<div
  class="swiper-container slider-mobile-gutter{% if section.settings.layout == 'grid' %} page-width{% endif %}{% if section.settings.show_text_below %} mobile-text-below{% endif %}"
  id="swiper-slideshow-{{ section.id }}"
  role="region"
  aria-label="{{ section.settings.accessibility_info | escape }}"
  data-loop="{{ section.settings.enable_looping }}"
  data-autoplay="{{ section.settings.auto_rotate }}"
  data-slidesPerView="{{ section.settings.slides_per_view }}"
  data-slidesPerGroup="{{ section.settings.slides_per_group }}"
  data-delay="{{ section.settings.change_slides_speed | times: 1000 }}"
  data-show-arrows="{{ section.settings.show_nav_button }}"
  data-slider-visual="{{ section.settings.slider_visual }}">

  <div class="swiper-wrapper">
    {%- for block in section.blocks -%}
      <div
        class="swiper-slide"
        id="Slide-{{ section.id }}-{{ forloop.index }}"
        role="group"
        aria-roledescription="{{ 'sections.swiper_slideshow.slide' | t }}"
        aria-label="{{ forloop.index }} {{ 'general.slider.of' | t }} {{ forloop.length }}"
        tabindex="-1">

        {%- style -%}
          #Slide-{{ section.id }}-{{ forloop.index }}
          .slide__overlay::after {
            opacity: {{ block.settings.image_overlay_opacity | divided_by: 100.0 }};
            content: '';
            display: block;
          }
        {%- endstyle -%}

        <div class="slide__media media{% if block.settings.image == blank %} placeholder{% endif %}">
          {%- if block.settings.image -%}
            {%- liquid
              assign height = block.settings.image.width | divided_by: block.settings.image.aspect_ratio | round
              if section.settings.image_behavior == 'ambient'
                assign sizes = '120vw'
                assign widths = '450,660,900,1320,1800,2136,2400,3600,7680'
              else
                assign sizes = '100vw'
                assign widths = '375,550,750,1100,1500,1780,2000,3000,3840'
              endif
              assign fetch_priority = 'auto'
              if forloop.first
                assign fetch_priority = 'high'
              endif
            -%}
            {%- if forloop.first -%}
              {{ block.settings.image | image_url: width: 3840 | image_tag: height: height, sizes: sizes, widths: widths, fetchpriority: fetch_priority }}
            {%- else -%}
              {{ block.settings.image | image_url: width: 3840 | image_tag: loading: 'lazy', height: height, sizes: sizes, widths: widths }}
            {%- endif -%}
          {%- else -%}
            {%- assign placeholder_slide = forloop.index | modulo: 2 -%}
            {%- if placeholder_slide == 1 -%}
              {{ 'hero-apparel-2' | placeholder_svg_tag: 'placeholder-svg' }}
            {%- else -%}
              {{ 'hero-apparel-1' | placeholder_svg_tag: 'placeholder-svg' }}
            {%- endif -%}
          {%- endif -%}
          <div class="slide__overlay"></div>
        </div>

        <div class="slide__text-wrapper banner__content banner__content--{{ block.settings.box_align }} page-width{% if block.settings.show_text_box == false %} banner--desktop-transparent{% endif %}">
          <div class="slide__text banner__box content-container content-container--full-width-mobile color-{{ block.settings.color_scheme }} gradient slide__text--{{ block.settings.text_alignment }} slide__text-mobile--{{ block.settings.text_alignment_mobile }}">

            {%- if block.settings.heading != blank -%}
              <h2 class="slide__heading inline-richtext {{ block.settings.heading_size }}">
                {{ block.settings.heading }}
              </h2>
            {%- endif -%}

            {%- if block.settings.subheading != blank -%}
              <div class="slide__subheading rte">
                <p>{{ block.settings.subheading }}</p>
              </div>
            {%- endif -%}

            {%- if block.settings.button_label != blank -%}
              <div class="slide__buttons">
                <a
                  {% if block.settings.link %}
                  href="{{ block.settings.link }}"
                  {% else %}
                  role="link"
                  aria-disabled="true"
                  {% endif %}
                  class="button {% if block.settings.button_style_secondary %}button--secondary{% else %}button--primary{% endif %}">
                  {{ block.settings.button_label | escape }}
                </a>
              </div>
            {%- endif -%}

          </div>
        </div>
      </div>
    {%- endfor -%}
  </div>

  {%- comment -%} Pagination / arrows can go here if needed {%- endcomment -%}

  {%- if section.blocks.size > 1 and section.settings.show_nav_button -%}
    <div class="swiper-navigation">
      <button class="swiper-button-prev" aria-label="{{ 'sections.swiper_slideshow.previous_slideshow' | t }}">
        <span class="svg-wrapper">{{ 'icon-caret.svg' | inline_asset_content }}</span>
      </button>
      <button class="swiper-button-next" aria-label="{{ 'sections.swiper_slideshow.next_slideshow' | t }}">
        <span class="svg-wrapper">{{ 'icon-caret.svg' | inline_asset_content }}</span>
      </button>
    </div>
  {%- endif -%}

  {%- if section.blocks.size > 1 and section.settings.slider_visual != blank -%}
    <div class="swiper-pagination swiper-pagination-{{ section.id }}">
      {%- if section.settings.slider_visual == 'dots' -%}
      <!-- Swiper will generate dots automatically -->
      {%- elsif section.settings.slider_visual == 'counter' or section.settings.slider_visual == 'numbers' -%}
        <span class="slider-counter--current">1</span>
        <span>/</span>
        <span class="slider-counter--total">{{ section.blocks.size }}</span>
      {%- endif -%}
    </div>
  {%- endif -%}

</div>

{% schema %}
  {
    "name": "Swiper Slideshow",
    "tag": "section",
    "class": "section",
    "disabled_on": {
      "groups": ["header", "footer"]
    },
    "max_blocks": 5,
    "settings": [
      {
        "type": "select",
        "id": "layout",
        "options": [
          {
            "value": "full_bleed",
            "label": "Full Bleed"
          }, {
            "value": "grid",
            "label": "Grid"
          }
        ],
        "default": "full_bleed",
        "label": "Layout"
      },
      {
        "type": "checkbox",
        "id": "show_nav_button",
        "label": "Show Prev or Next Button",
        "default": true
      },
      {
        "type": "range",
        "id": "slides_per_view",
        "label": "Slides Per View",
        "default": 1,
        "min": 1,
        "max": 5,
        "step": 1
      },
      {
        "type": "range",
        "id": "slides_per_group",
        "label": "Slides To Move Each Swipe",
        "default": 1,
        "min": 1,
        "max": 5,
        "step": 1
      }, {
        "type": "select",
        "id": "slide_height",
        "options": [
          {
            "value": "adapt_image",
            "label": "Adapt to Image"
          }, {
            "value": "small",
            "label": "Small"
          }, {
            "value": "medium",
            "label": "Medium"
          }, {
            "value": "large",
            "label": "Large"
          }
        ],
        "default": "medium",
        "label": "Slide Height"
      }, {
        "type": "select",
        "id": "slider_visual",
        "options": [
          {
            "value": "dots",
            "label": "Dots"
          }, {
            "value": "counter",
            "label": "Counter"
          }, {
            "value": "numbers",
            "label": "Numbers"
          }
        ],
        "default": "counter",
        "label": "Slider Visual"
      }, {
        "type": "checkbox",
        "id": "auto_rotate",
        "label": "Auto Rotate",
        "default": false
      }, {
        "type": "checkbox",
        "id": "enable_looping",
        "label": "Enable Looping",
        "default": true
      }, {
        "type": "range",
        "id": "change_slides_speed",
        "min": 3,
        "max": 9,
        "step": 2,
        "unit": "s",
        "label": "Change Slides Speed",
        "default": 5
      }, {
        "type": "select",
        "id": "image_behavior",
        "options": [
          {
            "value": "none",
            "label": "None"
          }, {
            "value": "ambient",
            "label": "Ambient"
          }
        ],
        "default": "none",
        "label": "Image Behavior"
      }, {
        "type": "header",
        "content": "Mobile Settings"
      }, {
        "type": "checkbox",
        "id": "show_text_below",
        "label": "Show Text Below",
        "default": true
      }, {
        "type": "header",
        "content": "Accessibility Settings"
      }, {
        "type": "text",
        "id": "accessibility_label",
        "label": "Accessibility Label",
        "default": "Slideshow section",
        "info": "Describes this section for screen readers"
      }
    ],
    "blocks": [
      {
        "type": "slide",
        "name": "Slide",
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "Slide Image"
          },
          {
            "type": "range",
            "id": "image_overlay_opacity",
            "min": 0,
            "max": 100,
            "step": 10,
            "unit": "%",
            "label": "Image Overlay Opacity",
            "default": 0
          },
          {
            "type": "inline_richtext",
            "id": "heading",
            "label": "Heading"
          },
          {
            "type": "select",
            "id": "heading_size",
            "label": "Heading Size",
            "options": [
              {
                "value": "h0",
                "label": "H0"
              },
              {
                "value": "h1",
                "label": "H1"
              },
              {
                "value": "h2",
                "label": "H2"
              },
              {
                "value": "hxl",
                "label": "HXL"
              }, {
                "value": "hxxl",
                "label": "HXXL"
              }
            ],
            "default": "h1"
          }, {
            "type": "inline_richtext",
            "id": "subheading",
            "label": "Subheading"
          }, {
            "type": "text",
            "id": "button_label",
            "label": "Button Label"
          }, {
            "type": "url",
            "id": "link",
            "label": "Button Link"
          }, {
            "type": "checkbox",
            "id": "button_style_secondary",
            "label": "Secondary Button Style",
            "default": false
          }, {
            "type": "checkbox",
            "id": "show_text_box",
            "label": "Show Text Box",
            "default": true
          }, {
            "type": "select",
            "id": "box_align",
            "label": "Box Align",
            "options": [
              {
                "value": "top-left",
                "label": "Top Left"
              },
              {
                "value": "top-center",
                "label": "Top Center"
              },
              {
                "value": "top-right",
                "label": "Top Right"
              },
              {
                "value": "middle-left",
                "label": "Middle Left"
              }, {
                "value": "middle-center",
                "label": "Middle Center"
              }, {
                "value": "middle-right",
                "label": "Middle Right"
              }, {
                "value": "bottom-left",
                "label": "Bottom Left"
              }, {
                "value": "bottom-center",
                "label": "Bottom Center"
              }, {
                "value": "bottom-right",
                "label": "Bottom Right"
              }
            ],
            "default": "middle-center"
          }, {
            "type": "select",
            "id": "text_alignment",
            "label": "Text Alignment",
            "options": [
              {
                "value": "left",
                "label": "Left"
              }, {
                "value": "center",
                "label": "Center"
              }, {
                "value": "right",
                "label": "Right"
              }
            ],
            "default": "center"
          }, {
            "type": "select",
            "id": "text_alignment_mobile",
            "label": "Text Alignment Mobile",
            "options": [
              {
                "value": "left",
                "label": "Left"
              }, {
                "value": "center",
                "label": "Center"
              }, {
                "value": "right",
                "label": "Right"
              }
            ],
            "default": "center"
          }, {
            "type": "color_scheme",
            "id": "color_scheme",
            "label": "Color Scheme",
            "default": "scheme-1"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Swiper Slideshow",
        "blocks": [
          {
            "type": "slide"
          }, {
            "type": "slide"
          }
        ]
      }
    ]
  }
{% endschema %}