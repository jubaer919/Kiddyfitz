{%- liquid
  assign products_to_display = collection.products.size
  if products_to_display > section.settings.products_to_show
    assign products_to_display = section.settings.products_to_show
  endif

  assign columns_mobile_int = section.settings.columns_mobile | plus: 0
  assign show_mobile_slider = false
  if section.settings.swipe_on_mobile and products_to_display > columns_mobile_int
    assign show_mobile_slider = true
  endif

  assign show_desktop_slider = false
  if section.settings.enable_desktop_slider and products_to_display > section.settings.columns_desktop
    assign show_desktop_slider = true
  endif
-%}

<ul
  id="Slider-{{ section.id }}"
  class="grid product-grid contains-card contains-card--product grid--{{ section.settings.columns_desktop }}-col-desktop grid--{{ section.settings.columns_mobile }}-col-tablet-down{% if show_mobile_slider or show_desktop_slider %} slider{% if show_desktop_slider %} slider--desktop{% endif %}{% if show_mobile_slider %} slider--tablet grid--peek{% endif %}{% endif %}"
  role="list"
  aria-label="{{ 'general.slider.name' | t }}">
  {%- for product in collection.products limit: section.settings.products_to_show -%}
    <li id="Slide-{{ section.id }}-{{ forloop.index }}" class="grid__item{% if show_mobile_slider or show_desktop_slider %} slider__slide{% endif %}">
      {% render 'card-one'
        ,
 card_product: product
        ,
 media_aspect_ratio: section.settings.image_ratio
        ,
 image_shape: section.settings.image_shape
        ,
 show_secondary_image: section.settings.show_secondary_image
        ,
 show_vendor: section.settings.show_vendor
        ,
 show_rating: section.settings.show_rating
        ,
 section_id: section.id
      %}
    </li>
  {%- else -%}
    {%- for i in (1..section.settings.columns_desktop) -%}
      <li class="grid__item">
        {% render 'card-product'
          , placeholder_image: 'product-apparel-1' %}
      </li>
    {%- endfor -%}
  {%- endfor -%}
</ul>

{% schema %}
  {
    "name": "Ajax Collection Grid",
    "class": "section",
    "settings": [
      {
        "type": "range",
        "id": "products_to_show",
        "min": 2,
        "max": 25,
        "step": 1,
        "default": 8,
        "label": "Maximum products to show"
      },
      {
        "type": "range",
        "id": "columns_desktop",
        "min": 1,
        "max": 6,
        "step": 1,
        "default": 4,
        "label": "Number of columns on desktop"
      },
      {
        "type": "select",
        "id": "columns_mobile",
        "options": [
          {
            "value": "1",
            "label": "1 column"
          }, {
            "value": "2",
            "label": "2 columns"
          }
        ],
        "default": "2",
        "label": "Number of columns on mobile"
      },
      {
        "type": "checkbox",
        "id": "swipe_on_mobile",
        "default": false,
        "label": "Enable swipe on mobile"
      }, {
        "type": "checkbox",
        "id": "enable_desktop_slider",
        "label": "Enable desktop slider",
        "default": false
      }, {
        "type": "select",
        "id": "image_ratio",
        "options": [
          {
            "value": "adapt",
            "label": "Adapt to image"
          }, {
            "value": "portrait",
            "label": "Portrait"
          }, {
            "value": "square",
            "label": "Square"
          }
        ],
        "default": "adapt",
        "label": "Image ratio"
      }, {
        "type": "checkbox",
        "id": "show_secondary_image",
        "default": true,
        "label": "Show second image on hover"
      }, {
        "type": "checkbox",
        "id": "show_vendor",
        "default": false,
        "label": "Show vendor"
      }, {
        "type": "checkbox",
        "id": "show_rating",
        "default": false,
        "label": "Show product rating"
      }
    ],
    "presets": [
      {
        "name": "Ajax Collection Grid"
      }
    ]
  }
{% endschema %}